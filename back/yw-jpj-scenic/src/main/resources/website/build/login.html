<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>义乌精品街--景区端</title>
	<script src="static/jquery-2.1.0.min.js"></script>
	<style type="text/css">
		body{
			text-align: center;
			background: #F7FAFC;
			overflow: hidden;
			background: #fff;
		}
		input{
			outline: none;
		}
		canvas{
			background: #F7FAFC;
		}
		.login-form{
			position: absolute;
			top:30%;
			left: 50%;
			width: 300px;
			margin-left: -150px;
		}
		.sign-flow .group-inputs {
			padding: 1px 0;
			border: 1px solid #d5d5d5;
			border-radius: 3px
		}

		.sign-flow .input-wrapper {
			position: relative;
			margin: 0;
			overflow: hidden
		}

		.sign-flow .input-wrapper+.input-wrapper {
			border-top: 1px solid #e8e8e8
		}

		.sign-flow .input-wrapper input {
			padding: 1em .8em;
			width: 100%;
			box-sizing: border-box;
			font-size:15px;
		}

		.sign-flow .input-wrapper input,
		.sign-flow .input-wrapper input:focus {
			border: 0;
			border-radius: 0;
			box-shadow: none;
			background: #fff
		}

		.sign-flow .input-wrapper input:-webkit-autofill {
			-webkit-box-shadow: 0 0 0 30px #fff inset;
			-webkit-text-fill-color: #555
		}

		.sign-flow a {
			color: inherit
		}

		.sign-flow .title {
			display: none
		}

		.sign-flow .sign-button {
			background: #0f88eb;
			box-shadow: none;
			border: 0;
			border-radius: 3px;
			line-height: 41px;
			color: #fff
		}

		.sign-flow .sign-button:focus,
		html.no-touchevents .sign-flow .sign-button:hover {
			background: #55abed
		}

		.sign-flow .signin-misc-wrapper,
		.sign-flow .button-wrapper{
			margin-top: 10px;
		}
		.sign-flow .signin-misc-wrapper{
			text-align: left;
		}

		.sign-flow .input-wrapper {
			position: relative
		}
		.sign-button {
			display: block;
			padding: 0;
			width: 100%;
			font-size: 15px;
			line-height: 33px;
			color: #fff;
			text-align: center;
			text-shadow: 0 1px 1px rgba(0, 0, 0, .2);
			background: #80c3f7;
			background: -webkit-linear-gradient(top, #80c3f7, #6bbaf8);
			background: linear-gradient(to bottom, #80c3f7, #6bbaf8);
			border: 1px solid #1D80CF;
			border-radius: 5px;
			box-shadow: inset 0 1px 0 rgba(255, 255, 255, .3), 0 1px 1px rgba(50, 50, 50, .05);
			outline: 0;
			cursor: pointer;
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0)
		}
		.sign-flow .sign-button:focus,
		.sign-flow .sign-button:hover {
			background: #55abed
		}
		.sign-button:active {
			color: #eee;
			border: 1px solid #0971C5;
			background: -webkit-linear-gradient(top, #5dadec, #51a4e6);
			background: linear-gradient(to bottom, #5dadec, #51a4e6);
			box-shadow: inset 0 1px 2px rgba(0, 0, 0, .1), 0 1px 0 rgba(255, 255, 255, .1)
		}

		.index-header {
			text-align: center
		}

		.index-header .logo {
			margin: 0 auto;
			/*width: 160px;*/
			height: 74px;
			/*background: url(/static/revved/img/index/logo.6837e927.png) no-repeat;*/
			background-size: contain
		}

		@media (max-width:740px) {
			.index-header .logo {
				width: 96px;
				height: 44.4px
			}
		}

		@media (-webkit-min-device-pixel-ratio:2),
		(min-resolution:2dppx),
		(min-resolution:192dpi) {
			.index-header .logo {
				/*background-image: url(/static/revved/img/index/logo@2x.e4e2b466.png)*/
			}
		}

		.index-header .logo.org-logo {
			width: 178px;
			height: 41px;
			/*background-image: url(/static/revved/img/org/signup/logo.57fac9a5.png)*/
		}

		@media (max-width:740px) {
			.index-header .logo.org-logo {
				width: 142.4px;
				height: 32.8px
			}
		}

		@media (-webkit-min-device-pixel-ratio:2),
		(min-resolution:2dppx),
		(min-resolution:192dpi) {
			.index-header .logo.org-logo {
				/*background-image: url(/static/revved/img/org/signup/logo@2x.ce86aca0.png)*/
			}
		}

		.index-header .subtitle {
			margin: 30px 0 20px;
			font-weight: 400;
			font-size: 18px;
			line-height: 1
		}
		.sign-flow label.error {
			padding: 0 8px;
			margin-top: 10px;
			color: #c33;
			cursor: text;
			background: #fff;
			background: -webkit-linear-gradient(left, rgba(255, 255, 255, 0), #fff 8px);
			background: linear-gradient(to right, rgba(255, 255, 255, 0), #fff 8px);
			display: none;
			opacity: 0;
			-ms-filter: "alpha(Opacity=0)";
			-webkit-transform: translate(20px, 0);
			-ms-transform: translate(20px, 0);
			transform: translate(20px, 0);
			-webkit-transition: .25s ease-out;
			transition: .25s ease-out
		}

		.sign-flow label.error.is-visible {
			display: inline-block;
			opacity: 1;
			-ms-filter: "alpha(Opacity=100)";
			-webkit-transform: translate(0, 0);
			-ms-transform: translate(0, 0);
			transform: translate(0, 0)
		}

		.sign-flow label.error a {
			text-decoration: none
		}

		.sign-flow label.error a,
		.sign-flow label.error span {
			color: #787878
		}
		.validate-img{
			position: absolute;
			top: 196px;
			right: -210px;
		}
		.validate-img > a{
			color: #787878;
		}
	</style>
</head>
<body>
<canvas id="Mycanvas"></canvas>

<div class="login-form">
	<div class="index-header">
		<h1 class="logo hide-text">义乌精品街--景区端</h1>
		<!-- <h2 class="subtitle">与世界分享你的知识、经验和见解</h2> -->
	</div>
	<form class="sign-flow">
		<div class="group-inputs">
			<div class="email input-wrapper">
				<input type="text" name="userName" aria-label="用户名" title="用户名" placeholder="用户名" required="" value="admin" />
			</div>
			<div class="input-wrapper">
				<input type="password" name="password" aria-label="密码" title="密码" placeholder="密码" required="" value="123456" />
			</div>
			<div class="input-wrapper">
				<input type="text" name="captcha" aria-label="验证码" title="验证码" placeholder="验证码" required="" value="111" />
			</div>
			<label class="validate-img" for="">
				<img title="点击更换" id="img_captcha" onclick="javascript:refreshCaptcha();" src="servlet/captchaCode" />
				(看不清,<a href="javascript:void(0);" onclick="javascript:refreshCaptcha();">换一张</a>)
			</label>
		</div>
		<label class="error" for="" id="J_error"></label>
		<div class="signin-misc-wrapper clearfix">
			<label class="remember-me">
				<input class="vertical-middle" type="checkbox" name="rememberMe" title="是否记住我"/> 记住我(一周之内有效)
			</label>
		</div>
		<div class="button-wrapper command">
			<a class="sign-button submit j-sign-btn" id="J_sign_btn">登录</a>
		</div>
	</form>
</div>

<script type="text/javascript">
	var _captcha_id = "#img_captcha";
	function refreshCaptcha() {
		$(_captcha_id).attr("src","/servlet/captchaCode?t=" + Math.random());
	}

	$(document).keypress(function(event){
		var keycode = (event.keyCode ? event.keyCode : event.which);
		if(keycode == '13'){
			getLoginSubmit();
		}
	});
	$('#J_sign_btn').click(function(){
		getLoginSubmit();
	});
	function getLoginSubmit(){
		var username = $.trim($('input[name=userName]').val());
		var password = $.trim($('input[name=password]').val());
		var rememberMe = $('input[name=rememberMe]').prop('checked');
		var captcha = $.trim($('input[name=captcha]').val());
		/*<![CDATA[*/
		if(username && password && captcha){
			$.ajax({
				type:"post",
				url:"/user/loginCheck",
				data:{
					userName:username,
					password:password,
					rememberMe:rememberMe,
					captcha:captcha
				},
				success:function(response){
					if(response.isSuccess){
						location.href = 'index.html';
					}else{
						$('#J_error').text(response.errorMessage).addClass('is-visible');
						refreshCaptcha();//更换验证码
					}
				}
			});
		}else{
			$('#J_error').text('登录名/密码/验证码为空').addClass('is-visible');
		}
		/*]]>*/
	}
</script>
<script>
	//定义画布宽高和生成点的个数
	var WIDTH = window.innerWidth, HEIGHT = window.innerHeight, POINT = 35;

	var canvas = document.getElementById('Mycanvas');
	canvas.width = WIDTH,
			canvas.height = HEIGHT;
	var context = canvas.getContext('2d');
	context.strokeStyle = 'rgba(0,0,0,0.02)',
			context.strokeWidth = 1,
			context.fillStyle = 'rgba(0,0,0,0.05)';
	var circleArr = [];

	//线条：开始xy坐标，结束xy坐标，线条透明度
	function Line (x, y, _x, _y, o) {
		this.beginX = x,
				this.beginY = y,
				this.closeX = _x,
				this.closeY = _y,
				this.o = o;
	}
	//点：圆心xy坐标，半径，每帧移动xy的距离
	function Circle (x, y, r, moveX, moveY) {
		this.x = x,
				this.y = y,
				this.r = r,
				this.moveX = moveX,
				this.moveY = moveY;
	}
	//生成max和min之间的随机数
	function num (max, _min) {
		var min = arguments[1] || 0;
		return Math.floor(Math.random()*(max-min+1)+min);
	}
	// 绘制原点
	function drawCricle (cxt, x, y, r, moveX, moveY) {
		var circle = new Circle(x, y, r, moveX, moveY)
		cxt.beginPath()
		cxt.arc(circle.x, circle.y, circle.r, 0, 2*Math.PI)
		cxt.closePath()
		cxt.fill();
		return circle;
	}
	//绘制线条
	function drawLine (cxt, x, y, _x, _y, o) {
		var line = new Line(x, y, _x, _y, o)
		cxt.beginPath()
		cxt.strokeStyle = 'rgba(0,0,0,'+ o +')'
		cxt.moveTo(line.beginX, line.beginY)
		cxt.lineTo(line.closeX, line.closeY)
		cxt.closePath()
		cxt.stroke();

	}
	//初始化生成原点
	function init () {
		circleArr = [];
		/*<![CDATA[*/
		for (var i = 0; i < POINT; i++) {
			circleArr.push(drawCricle(context, num(WIDTH), num(HEIGHT), num(15, 2), num(10, -10)/40, num(10, -10)/40));
		}
		/*]]>*/
		draw();
	}

	//每帧绘制
	function draw () {
		context.clearRect(0,0,canvas.width, canvas.height);
		/*<![CDATA[*/
		for (var i = 0; i < POINT; i++) {
			drawCricle(context, circleArr[i].x, circleArr[i].y, circleArr[i].r);
		}
		for (var i = 0; i < POINT; i++) {
			for (var j = 0; j < POINT; j++) {
				if (i + j < POINT) {
					var A = Math.abs(circleArr[i+j].x - circleArr[i].x),
							B = Math.abs(circleArr[i+j].y - circleArr[i].y);
					var lineLength = Math.sqrt(A*A + B*B);
					var C = 1/lineLength*7-0.009;
					var lineOpacity = C > 0.03 ? 0.03 : C;
					if (lineOpacity > 0) {
						drawLine(context, circleArr[i].x, circleArr[i].y, circleArr[i+j].x, circleArr[i+j].y, lineOpacity);
					}
				}
			}
		}
		/*]]>*/
	}

	//调用执行
	window.onload = function () {
		init();
		setInterval(function () {
			/*<![CDATA[*/
			for (var i = 0; i < POINT; i++) {
				var cir = circleArr[i];
				cir.x += cir.moveX;
				cir.y += cir.moveY;
				if (cir.x > WIDTH) cir.x = 0;
				else if (cir.x < 0) cir.x = WIDTH;
				if (cir.y > HEIGHT) cir.y = 0;
				else if (cir.y < 0) cir.y = HEIGHT;

			}
			/*]]>*/
			draw();
		}, 16);
	}

</script>
</body>
</html>
